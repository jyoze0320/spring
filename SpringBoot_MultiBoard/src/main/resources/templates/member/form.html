<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/include/header :: header}"></head> 
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function() {
    // JavaScript form validation
    var checkPassword = function(str) {
      var re = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$/;
      return re.test(str);
    };

    var checkForm = function(e) {
      if(this.username.value == "") {
        alert("Error: Username cannot be blank!");
        this.username.focus();
        e.preventDefault(); // equivalent to return false
        return;
      }
      re = /^\w+$/;
      if(!re.test(this.username.value)) {
        alert("Error: Username must contain only letters, numbers and underscores!");
        this.username.focus();
        e.preventDefault();
        return;
      }
      if(this.pwd1.value != "" && this.pwd1.value == this.pwd2.value) {
        if(!checkPassword(this.pwd1.value)) {
          alert("The password you have entered is not valid!");
          this.pwd1.focus();
          e.preventDefault();
          return;
        }
      } else {
        alert("Error: Please check that you've entered and confirmed your password!");
        this.pwd1.focus();
        e.preventDefault();
        return;
      }
      alert("Both username and password are VALID!");
    };

    var myForm = document.getElementById("joinForm");
    myForm.addEventListener("submit", checkForm, true);

    // HTML5 form validation
    var supports_input_validity = function() {
      var i = document.createElement("input");
      return "setCustomValidity" in i;
    }

    if(supports_input_validity()) {
      var usernameInput = document.getElementById("userid");
      usernameInput.setCustomValidity(usernameInput.title);

      var pwd1Input = document.getElementById("password");
      pwd1Input.setCustomValidity(pwd1Input.title);

      var pwd2Input = document.getElementById("password_re");

      // input key handlers

      usernameInput.addEventListener("keyup", function() {
        usernameInput.setCustomValidity(this.validity.patternMismatch ? usernameInput.title : "");
      }, false);

      pwd1Input.addEventListener("keyup", function() {
        this.setCustomValidity(this.validity.patternMismatch ? pwd1Input.title : "");
        if(this.checkValidity()) {
          pwd2Input.pattern = this.value;
          pwd2Input.setCustomValidity(pwd2Input.title);
        } else {
          pwd2Input.pattern = this.pattern;
          pwd2Input.setCustomValidity("");
        }
      }, false);

      pwd2Input.addEventListener("keyup", function() {
        this.setCustomValidity(this.validity.patternMismatch ? pwd2Input.title : "");
      }, false);

    }

  }, false);
</script>
<body>
<div th:replace="~{/include/body-header :: bodyHeader}"></div>
<div class="container">
	<div class="pg-opt">
        <div class="row">
            <div class="col-md-6 pc">
                <h2>[[#{INSERT_USER_INFO}]]</h2>
            </div>
            <div class="col-md-6">
                <ol class="breadcrumb">
                    <li>[[#{MEMBER}]]</li>
                    <li class="active">[[#{INSERT_USER_INFO}]]</li>
                </ol>
            </div>
        </div>
    </div>
	<div class="content">
	<form th:action="@{/member/insert}" method="post" id="joinForm" class="form-horizontal">
	<div class="form-group">
      <label class="control-label col-sm-2" for="userid">[[#{MEMBER_ID}]]</label>
      <div class="col-sm-4">
        <input type="text" name="userid" id="userid" th:value="${member.userid}" th:readonly="${member.userid!=null}" pattern="\w+" class="form-control" th:placeholder="#{MEMBER_ID}" required>
      </div>
    </div>
	<div class="form-group">
      <label class="control-label col-sm-2" for="password">[[#{MEMBER_PW}]]</label>
      <div class="col-sm-4">
        <input type="password" name="password" id="password" th:value="${member.password}" class="form-control" th:title="#{PASSWORD_TITLE}" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}" required>
      </div>
    </div>
    <div class="form-group">
      <label class="control-label col-sm-2" for="password_re">[[#{MEMBER_PW_RE}]]</label>
      <div class="col-sm-4">
        <input type="password" name="password_re" id="password_re" class="form-control" th:title="#{PASSWORD_RE_TITLE}" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}" required>
      </div>
    </div>
	<div class="form-group">
      <label class="control-label col-sm-2" for="name">[[#{MEMBER_NAME}]]</label>
      <div class="col-sm-4">
        <input type="text" name="name" id="name" th:value="${member.name}" class="form-control" required>
      </div>
    </div>
	<div class="form-group">
      <label class="control-label col-sm-2" for="phone">[[#{MEMBER_PHONE}]]</label>
      <div class="col-sm-6">
        <input type="text" name="phone" id="phone" th:value="${member.phone}" class="form-control" required>
      </div>
    </div>
	<div class="form-group">
      <label class="control-label col-sm-2" for="email">[[#{MEMBER_EMAIL}]]</label>
      <div class="col-sm-8">
        <input type="email" name="email" id="email" th:value="${member.email}" class="form-control" required>
      </div>
    </div>
    <div class="form-group">
    	<div class="col-sm-offset-2 col-sm-8">
		<input type="submit" class="btn btn-info" th:value="#{SAVE}">
		<input type="reset" class="btn btn-info" th:value="#{CANCEL}">
		</div>
	</div>
	</form>
	</div>
</div>
<footer th:replace="~{/include/footer :: footer}"></footer> 
</body>
</html>